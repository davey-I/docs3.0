<!DOCTYPE html>
<html><head>
<title data-folder-path="/Networking">vpn</title>
<link href=" ../../static/style.css" rel="stylesheet"/>
<link href="../../prism/prism.css" rel="stylesheet"/>
</head>
<body class="body">
<div class="page-folder-header-div">
<h1 class="pagetitle" data-folder-path="Networking">vpn</h1>
<a href="./../..">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M3 11L12 4L21 11"></path>
<path d="M5 10V20H19V10"></path>
<path d="M10 20V14H14V20"></path>
</svg>
</a>
</div>
<!-- Sidebar -->
<div class="sidbear-enclosure-open" id="sidbear-enclosure-open-vpn">
<button class="sidbear-enclosure-button-open" id="sidbear-enclosure-button-vpn" onclick="toggle_sidebar()" type="button">
<svg fill="white" height="30" viewBox="0 0 100 80" width="30" xmlns="http://www.w3.org/2000/svg">
<rect height="10" width="100"></rect>
<rect height="10" width="100" y="30"></rect>
<rect height="10" width="100" y="60"></rect>
</svg>
</button>
<div class="sidebar-mainbox-open" id="sidebar-mainbox-vpn">
<div class="sidebar-subbox-open" id="sidebar-subbox-1" onclick=" append_foldable_content()">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" x2="12" y1="8" y2="16"></line>
<line x1="8" x2="16" y1="12" y2="12"></line>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-2">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-3">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
</div>
</div>
<script src="../../prism/prism.js"></script>
<script src="../../static/script.js"></script>
<!--## vpn-wireguard #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-vpn-wireguard">
<h2 class="foldable-title" id="foldable-title-vpn-wireguard">vpn-wireguard</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('vpn-wireguard')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('vpn','editable-paragraph-vpn-wireguard', 'foldable-content-penButton-vpn-wireguard')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-vpn-wireguard" onclick="add_subdiv('editable-paragraph-vpn-wireguard')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-vpn-wireguard">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-vpn-wireguard" onclick="save_editable_content('vpn','editable-paragraph-vpn-wireguard', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-vpn-wireguard"><div class="foldable-container" id="foldcontainer-wireguard-setup-tocco">
<h2 class="foldable-title" id="foldable-title-wireguard-setup-tocco">wireguard-setup-tocco</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('wireguard-setup-tocco')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('vpn','editable-paragraph-wireguard-setup-tocco', 'foldable-content-penButton-wireguard-setup-tocco')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-wireguard-setup-tocco">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-wireguard-setup-tocco" onclick="save_editable_content('vpn','editable-paragraph-wireguard-setup-tocco', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-wireguard-setup-tocco"><pre>Set up Wireguard VPN
--------------------

Configure VPN
`````````````

#. Install Wireguard::

       apt install openresolv wireguard wireguard-tools




#. Generate private / public key pair::

       (private=$(wg genkey); public=$(wg pubkey &lt;&lt;&lt;$private); echo "private_key: $private; public_key: $public")

#. Submit the **public_key** to :term:`Operations Public channel` and ask to be
   granted VPN access.

   Make sure you keep the **private_key**, you'll need it.

#. You'll get a VPN config back. Replace the *XXX* placeholder in it with your
   **private_key** and then store it at */etc/wireguard/wg-tocco.conf*.

.. important::

   This is a per-device key. Generate a fresh key if you need access on an
   addational device. Using the same key on two devices will not work.

.. tip::

    For admins: see :ref:`accounts-wireguard`.

Test VPN
````````

#. Enable VPN::

       wg-quick up wg-tocco

#. Test connection::

       ping -A -c 3 10.148.60.1
       ping -A -c 3 2001:8e3:5396:c9b::1
       ping -A -c 3 tocco.ch

#. Disable VPN::

       wg-quick down wg-tocco


</pre></div>
</div>
</div>

<!--## new-laptop-setup-new-keys? #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-new-laptop-setup-new-keys?">
<h2 class="foldable-title" id="foldable-title-new-laptop-setup-new-keys?">new-laptop-setup-new-keys?</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('new-laptop-setup-new-keys?')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('vpn','editable-paragraph-new-laptop-setup-new-keys?', 'foldable-content-penButton-new-laptop-setup-new-keys?')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-new-laptop-setup-new-keys?">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-new-laptop-setup-new-keys?" onclick="save_editable_content('vpn','editable-paragraph-new-laptop-setup-new-keys?', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-new-laptop-setup-new-keys?"><html><head></head><body><pre>- Quick note : If someone sets up his laptop completely new
   There should be no need to change/replace the keys anywhere
   The user only needs to copy the Keys on his machines before
   starting the process..

- When new machine runs again and he setsup the WG again, it should<br/>
   be enough to just add the copied keys...

<div class="frame">
<span class="highlighteryellow"><b>Q</b></span>: In theory there would be no need for a new WG-Keypair if someone
sets up a new machine ?

<span class="highlightergreen2"><b>A</b></span>: Right, but it's a good time go rotate
keys. My recommendation generally is to rotate both the SSH key and WG keys.
What you can't do though, is use he same same WG key on to machine at the same time.
WG uses the key, and nothing else, to distinguish clients
</div>
</pre></body></html></div>
</div>
</div>
</div>
</div>
</div>
</body></html><!--## wireguard-setup-tocco #################################################################################################################-->