<!DOCTYPE html>
<html><head>
<title data-folder-path="/Tocco">tocco-CI-CD</title>
<link href=" ../../static/style.css" rel="stylesheet"/>
<link href="../../prism/prism.css" rel="stylesheet"/>
</head>
<body class="body">
<div class="page-folder-header-div">
<h1 class="pagetitle" data-folder-path="Tocco">tocco-CI-CD</h1>
<a href="./../..">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M3 11L12 4L21 11"></path>
<path d="M5 10V20H19V10"></path>
<path d="M10 20V14H14V20"></path>
</svg>
</a>
</div>
<!-- Sidebar -->
<div class="sidbear-enclosure-open" id="sidbear-enclosure-open-tocco-CI-CD">
<button class="sidbear-enclosure-button-open" id="sidbear-enclosure-button-tocco-CI-CD" onclick="toggle_sidebar()" type="button">
<svg fill="white" height="30" viewBox="0 0 100 80" width="30" xmlns="http://www.w3.org/2000/svg">
<rect height="10" width="100"></rect>
<rect height="10" width="100" y="30"></rect>
<rect height="10" width="100" y="60"></rect>
</svg>
</button>
<div class="sidebar-mainbox-open" id="sidebar-mainbox-tocco-CI-CD">
<div class="sidebar-subbox-open" id="sidebar-subbox-1" onclick=" append_foldable_content()">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" x2="12" y1="8" y2="16"></line>
<line x1="8" x2="16" y1="12" y2="12"></line>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-2">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-3">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
</div>
</div>
<script src="../../prism/prism.js"></script>
<script src="../../static/script.js"></script>
<!--## overview #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-overview">
<h2 class="foldable-title" id="foldable-title-overview">overview</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('overview')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('tocco-CI-CD','editable-paragraph-overview', 'foldable-content-penButton-overview')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-overview" onclick="add_subdiv('editable-paragraph-overview')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-overview">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-overview" onclick="save_editable_content('tocco-CI-CD','editable-paragraph-overview', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-overview"><pre><h3>Deployment vs. Migration</h3>
- Explained <a src="https://docs.tocco.ch/devops/deployment/intro.html">here</a>

- A <i>deployment</i> is an update within the <i>same minor version</i>.
For instance, an update <i>within 3.0.</i> ( Happens in <strong>Stage and Production</strong> )


- <i>stage-deployments</i> result in building a new docker-image, that gets pushed
to Openshift.


- <i>prod-deployments</i> docker-image from stage gets copied and pushed
to Openshift

- A <b>migration</b> is an update across a <b>major or minor</b> version.
For instance, an update from <b>3.0 to 3.1</b>.


- During a <b>migration</b>, an additional <b>testnew</b> system is created and
updated to the desired version.
</pre></div>
</div>
</div>
<!--## gerrit-ci-cd #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-gerrit-ci-cd">
<h2 class="foldable-title" id="foldable-title-gerrit-ci-cd">gerrit-ci-cd</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('gerrit-ci-cd')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('tocco-CI-CD','editable-paragraph-gerrit-ci-cd', 'foldable-content-penButton-gerrit-ci-cd')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-gerrit-ci-cd" onclick="add_subdiv('editable-paragraph-gerrit-ci-cd')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-gerrit-ci-cd">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-gerrit-ci-cd" onclick="save_editable_content('tocco-CI-CD','editable-paragraph-gerrit-ci-cd', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-gerrit-ci-cd"><pre>- Gerrit creates a “Pull request” for every commit made.
if there is <i>one</i> additional commit, it can be added with --amend
if <i>multiple commits</i> <b> git rebase -i </b>

- Every commit must be reviewed by another person, the reviewer
can give a ranking of:
<ul>
<li> -2: Do not submit </li>
<li> -1: I would prefer that you didnt submit this </li>
<li> +1: Looks good to me, but someone else must approve </li>
<li> +2: Looks good to me, approved </li>
</ul>
- A commit needs to have a +2 so that it can be submitted (merged)
It also needs a <b>+1 from the Teamcity verification</b>


- The <b>Teamcity verification (V)</b> starts automatically (as soon as a Teamcity agent is idle).
When the verification returns a -1, the jobs needs to be checked for the cause.
Also if no number or checkmark at all is appearing under <b>(V)</b>.
This is probably a  trigger-problem. (see image below)
<img height="300" src="../../images/gerrit_verification.png" width="100"/>

<div class="frame">- Once a commit has been submitted, <b>additional jobs will be started</b> to merge the changes
into the releases branch and to higher versions (if the changes were made on an older version).
Merging to higher versions can sometimes lead to merge conflicts which then need to be fixed.
</div>
</pre></div>
</div>
</div>
<!--## openshift-nginx #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-openshift-nginx">
<h2 class="foldable-title" id="foldable-title-openshift-nginx">openshift-nginx</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('openshift-nginx')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('tocco-CI-CD','editable-paragraph-openshift-nginx', 'foldable-content-penButton-openshift-nginx')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-openshift-nginx" onclick="add_subdiv('editable-paragraph-openshift-nginx')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-openshift-nginx">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-openshift-nginx" onclick="save_editable_content('tocco-CI-CD','editable-paragraph-openshift-nginx', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-openshift-nginx"><h2>How does the CI/CD Pipeline for the Tocco Nginx Webserver work ?</h2>

<div class="foldable-container" id="foldcontainer-1.Pipeline-Trigger-gitlab-ci.yml">
<h2 class="foldable-title" id="foldable-title-1.Pipeline-Trigger-gitlab-ci.yml">1.Pipeline-Trigger-gitlab-ci.yml</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('1.Pipeline-Trigger-gitlab-ci.yml')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('tocco-CI-CD','editable-paragraph-1.Pipeline-Trigger-gitlab-ci.yml', 'foldable-content-penButton-1.Pipeline-Trigger-gitlab-ci.yml')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-1.Pipeline-Trigger-gitlab-ci.yml">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-1.Pipeline-Trigger-gitlab-ci.yml" onclick="save_editable_content('tocco-CI-CD','editable-paragraph-1.Pipeline-Trigger-gitlab-ci.yml', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-1.Pipeline-Trigger-gitlab-ci.yml"><html><head></head><body><pre>- Whenever you <b>push to GitLab</b>, the .gitlab-ci.yml defines
  <b>what jobs run</b> (build, test, deploy, etc.).


- GitLab runners then pick up those jobs.
</pre></body></html></div>
</div>
</div>
</div>
</div>
</div>
</body></html><!--## 1.Pipeline-Trigger-gitlab-ci.yml #################################################################################################################-->