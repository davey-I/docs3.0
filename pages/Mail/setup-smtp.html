<!DOCTYPE html>
<html><head>
<title data-folder-path="/Mail">setup-smtp</title>
<link href=" ../../static/style.css" rel="stylesheet"/>
<link href="../../prism/prism.css" rel="stylesheet"/>
</head>
<body class="body">
<div class="page-folder-header-div">
<h1 class="pagetitle" data-folder-path="Mail">setup-smtp</h1>
<a href="./../..">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M3 11L12 4L21 11"></path>
<path d="M5 10V20H19V10"></path>
<path d="M10 20V14H14V20"></path>
</svg>
</a>
</div>
<!-- Sidebar -->
<div class="sidbear-enclosure-open" id="sidbear-enclosure-open-setup-smtp">
<button class="sidbear-enclosure-button-open" id="sidbear-enclosure-button-setup-smtp" onclick="toggle_sidebar()" type="button">
<svg fill="white" height="30" viewBox="0 0 100 80" width="30" xmlns="http://www.w3.org/2000/svg">
<rect height="10" width="100"></rect>
<rect height="10" width="100" y="30"></rect>
<rect height="10" width="100" y="60"></rect>
</svg>
</button>
<div class="sidebar-mainbox-open" id="sidebar-mainbox-setup-smtp">
<div class="sidebar-subbox-open" id="sidebar-subbox-1" onclick=" append_foldable_content()">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" x2="12" y1="8" y2="16"></line>
<line x1="8" x2="16" y1="12" y2="12"></line>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-2">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-3">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
</div>
</div>
<script src="../../prism/prism.js"></script>
<script src="../../static/script.js"></script>
<!--## connection-testing #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-connection-testing">
<h2 class="foldable-title" id="foldable-title-connection-testing">connection-testing</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('connection-testing')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('setup-smtp','editable-paragraph-connection-testing', 'foldable-content-penButton-connection-testing')" type="button"><svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-connection-testing" onclick="add_subdiv('editable-paragraph-connection-testing')" type='*button"'><svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-connection-testing">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-connection-testing" onclick="save_editable_content('setup-smtp','editable-paragraph-connection-testing', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-connection-testing">
<div class="foldable-container" id="foldcontainer-openssl s_client">
<h2 class="foldable-title" id="foldable-title-openssl s_client">openssl s_client</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('openssl s_client')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('setup-smtp','editable-paragraph-openssl s_client', 'foldable-content-penButton-openssl s_client')" type="button"><svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-openssl s_client">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-openssl s_client" onclick="save_editable_content('setup-smtp','editable-paragraph-openssl s_client', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-openssl s_client"><h3>openssl s_client tool</h3>
<ul>
<li> If we want to test TLS, especially STARTTLS we can use the <b>s_client</b> tool </li><br/>
<li>Documentation at : <a href="https://docs.openssl.org/1.0.2/man1/s_client/">openssl_docs</a></li><br/>
<li> Base command: <b>openssl s_client -connect vsp1.example.local:25 -starttls smtp</b> </li><br/>
<li> It might be necesarry to ad the option <b>-crlf</b> this option translated a line feed from the<br/>
terminal into CR+LF as required by some servers.
</li><br/>
<li> Two examples: where <b>one server supports starttls</b> and one <b>does not</b></li><br/>
</ul>
<!--Prism bash pretyfier code example-->
    <pre>        <code class="lang-bash">
            # openssl s_client -connect vsp1.example.local:25 -starttls smtp -crlf
(cut)
CONNECTED(00000003)
didn't found starttls in server response, try anyway...
139702030079656:error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol:s23_clnt.c:774:
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 177 bytes and written 325 bytes
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE        
        </code>
    </pre>
<!--Prism bash pretyfier code example-->
    <pre>        <code class="lang-bash">
            # openssl s_client -connect vsp2.example.local:25 -starttls smtp -crlf
(cut)
SSL-Session:
Protocol : TLSv1.2
Cipher : ECDHE-RSA-AES256-GCM-SHA384
Session-ID: 140C627F8364C06E74204CEBA31057415B1A24EC2E5D9B996C6F3277DB18F364
Session-ID-ctx:
Master-Key: C565114C052EDA50B176EA7962F415C3E2BD8A0FC62E243C592BB72164AAAE9625CE80EE81BF88FD8C480EAC4E20A74C
Key-Arg : None
PSK identity: None
PSK identity hint: None
SRP username: None
TLS session ticket lifetime hint: 300 (seconds)
TLS session ticket:
0000 - 73 04 63 bd 84 16 fd e4-a0 93 26 e0 71 3c 08 0b s.c.......&amp;.qV)v.........
0070 - 19 08 d1 c2 14 ee da 69-cc 85 77 f6 13 39 3c f9 .......i..w..9&lt;.
0080 - 8b 60 38 67 3c e9 f3 18-08 20 f6 1c 10 16 77 7f .`8gV.../..


Start Time: 1474028496
Timeout : 300 (sec)
Verify return code: 18 (self signed certificate)       
        </code>
    </pre>
<!--## openssl s_client #################################################################################################################-->
</div>
</div>
</div>
<!--## commands-to-test-credentials #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-commands-to-test-credentials">
<h2 class="foldable-title" id="foldable-title-commands-to-test-credentials">commands-to-test-credentials</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('commands-to-test-credentials')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('setup-smtp','editable-paragraph-commands-to-test-credentials', 'foldable-content-penButton-commands-to-test-credentials')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-commands-to-test-credentials">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-commands-to-test-credentials" onclick="save_editable_content('setup-smtp','editable-paragraph-commands-to-test-credentials', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-commands-to-test-credentials"><html><head></head><body><h3>Credentials used</h3>
<table>
<tbody>
<tr>
<th>smtp server name                     </th>
<th>smtp server port                     </th>
<th>e-mail                     </th>
<th>password                     </th>
</tr>
<tr>
<td>mydomain.com</td>
<td>587</td>
<td>myuser@mydomain.com      </td>
<td>mypasswd</td>
</tr>
</tbody>
</table> 

<pre><h3>1 – convert the e-mail to base64</h3>
<pre><code class="lang-bash">echo -n "myuser@mydoamin.com" | base64</code></pre>

<h3>2 – convert the password to base64</h3>
<pre><code class="lang-bash">echo -n "mypasswd" | base64</code></pre>



<h3> For Tocco-Debuging: Do this <i>inside the pod</i> via terminal</h3>


<h3>3 – connect to the smtp server using openssl</h3>
<pre><code class="lang-bash">openssl s_client -debug -starttls smtp -crlf -connect mydoamin.com:587</code></pre>

<div class="frame">
wait until you see a:
<pre><code class="lang-bash">---

250 STARTTLS</code></pre>
or a
---
<pre><code class="lang-bash">Post-Handshake New Session Ticket arrived:
SSL-Session:
.
.
Verify return code: 0 (ok)
---
read R BLOCK
</code></pre>
Otherwise <b>don't</b> send the credentials ( no encryption)
</div>

<h3>4 – send the commands to the server to validate the credentials</h3>

<pre><code class="lang-bash">EHLO</code></pre>
(Server will sent back something like:)
<pre><code class="lang-bash">
250-smtp.sendgrid.net
250-8BITMIME
250-PIPELINING
250-SIZE 31457280
250-STARTTLS
250-AUTH PLAIN LOGIN
250 AUTH=PLAIN LOGIN</code></pre>
<div class="frame">In some cases we could also see a <b>501</b>#5.0.0 EHLO requires domain address
which indicates, that we also have to prevent a domaniname next to the EHLO: EHLO &lt;domainname&gt;)
</div>

(After that we can type <b>"AUTH LOGIN"</b> + b64 encoded credentials)
<pre><code class="lang-bash">
AUTH LOGIN
(Response from Server like : 334)
{$USERNAME_IN_B64}
(Response from Server like : 334)
{$PASSWORD_IN_B64}
</code></pre>
If the credentials are correct the output will be: <i>Authentication successful</i>

</pre></body></html></div>
</div>
</div>

<!--## smtp-starttls-FAQ #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-smtp-starttls-FAQ">
<h2 class="foldable-title" id="foldable-title-smtp-starttls-FAQ">smtp-starttls-FAQ</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('smtp-starttls-FAQ')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('setup-smtp','editable-paragraph-smtp-starttls-FAQ', 'foldable-content-penButton-smtp-starttls-FAQ')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-smtp-starttls-FAQ">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-smtp-starttls-FAQ" onclick="save_editable_content('setup-smtp','editable-paragraph-smtp-starttls-FAQ', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-smtp-starttls-FAQ"><pre><h3>Frequently asked questions about StartTLS / TLS / SMTP etc.</h3>


<b>Q.</b> What port does StartTLS use?
<i>A.</i> StartTLS typically uses port 587, which is the standard for email submission with encryption. Ports 25 
 and 2525 also support StartTLS, but port 587 is recommended for client applications.


<b>Q.</b> Is StartTLS secure?
<i>A.</i> StartTLS provides strong security when properly configured, but it's not foolproof. It's vulnerable to
man-in-the-middle attacks during the initial unencrypted handshake. For maximum security, use StartTLS with
certificate verification enabled.


<b>Q.</b> How do I enable StartTLS?
<i>A.</i> Enable StartTLS in your email client's SMTP settings. Look for options like "Use STARTTLS," "Explicit TLS,"
or "TLS/StartTLS." Avoid "SSL" or "Implicit TLS" options, which use different encryption methods.


<b>Q.</b> What's the difference between StartTLS and SSL?
<i>A.</i> StartTLS upgrades an existing connection to encrypted, while SSL creates an encrypted connection
from the start. StartTLS is more flexible because it allows the same port to handle both encrypted and
unencrypted connections.


<b>Q.</b> Why am I getting "StartTLS is required" errors?
<i>A.</i> This error means the mail server requires encryption, but your email client isn't requesting it.
Check that StartTLS is enabled in your SMTP configuration and you're using the correct port (usually 587).


<b>Q.</b> Can I use StartTLS with any email provider?
<i>A.</i> Most modern email providers support StartTLS, but older or less secure providers might not.
Test your connection first, and consider switching providers if StartTLS isn't supported.
</pre>



</div>
</div>
</div>
</div>
</div>
</div>
</body></html>