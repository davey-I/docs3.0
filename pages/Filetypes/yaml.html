<!DOCTYPE html>
<html><head>
<title data-folder-path="/Filetypes">yaml</title>
<link href=" ../../static/style.css" rel="stylesheet"/>
<link href="../../prism/prism.css" rel="stylesheet"/>
</head>
<body class="body">
<div class="page-folder-header-div">
<h1 class="pagetitle" data-folder-path="Filetypes">yaml</h1>
<a href="./../..">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M3 11L12 4L21 11"></path>
<path d="M5 10V20H19V10"></path>
<path d="M10 20V14H14V20"></path>
</svg>
</a>
</div>
<!-- Sidebar -->
<div class="sidbear-enclosure-open" id="sidbear-enclosure-open-yaml">
<button class="sidbear-enclosure-button-open" id="sidbear-enclosure-button-yaml" onclick="toggle_sidebar()" type="button">
<svg fill="white" height="30" viewBox="0 0 100 80" width="30" xmlns="http://www.w3.org/2000/svg">
<rect height="10" width="100"></rect>
<rect height="10" width="100" y="30"></rect>
<rect height="10" width="100" y="60"></rect>
</svg>
</button>
<div class="sidebar-mainbox-open" id="sidebar-mainbox-yaml">
<div class="sidebar-subbox-open" id="sidebar-subbox-1" onclick=" append_foldable_content()">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" x2="12" y1="8" y2="16"></line>
<line x1="8" x2="16" y1="12" y2="12"></line>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-2">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-3">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
</div>
</div>
<script src="../../prism/prism.js"></script>
<script src="../../static/script.js"></script>
<!--## yaml-with-jinja2 #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-yaml-with-jinja2">
<h2 class="foldable-title" id="foldable-title-yaml-with-jinja2">yaml-with-jinja2</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('yaml-with-jinja2')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('yaml','editable-paragraph-yaml-with-jinja2', 'foldable-content-penButton-yaml-with-jinja2')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-yaml-with-jinja2" onclick="add_subdiv('editable-paragraph-yaml-with-jinja2')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-yaml-with-jinja2">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-yaml-with-jinja2" onclick="save_editable_content('yaml','editable-paragraph-yaml-with-jinja2', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-yaml-with-jinja2"><html><head></head><body><h1 class="highlighterred2">BE AWARE THAT...</h1>
<h2 class="highlighteryellow">- IF you add {% if ... %} in to template files no INDENTATION in front of them</h2>
<pre><code class="lang-yaml"></code></pre>


<div class="foldable-container" id="foldcontainer-yaml-with-jinja2-elements">
<h2 class="foldable-title" id="foldable-title-yaml-with-jinja2-elements">yaml-with-jinja2-elements</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('yaml-with-jinja2-elements')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('yaml','editable-paragraph-yaml-with-jinja2-elements', 'foldable-content-penButton-yaml-with-jinja2-elements')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-yaml-with-jinja2-elements">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-yaml-with-jinja2-elements" onclick="save_editable_content('yaml','editable-paragraph-yaml-with-jinja2-elements', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-yaml-with-jinja2-elements"><pre><h3>What are these Elements in the following code-snippet called ?</h3>

<div class="frame">Overall, This would be called a <b>YAML mapping (or dictionary) containing Jinja2 template</b>
syntax within a multi-line string value. The combination is often used in configuration
management tools like Ansible, where you need dynamic configuration generation.
</div>
<pre><code class="lang-yaml">
nginx_envs:
  # /admin/ only
  APACHE2_ADMIN_CSP: |-
   {%- if admin_content_security_policy is not none and admin_content_security_policy|length &gt; 0 -%}
   {%-   for directive, urls in admin_content_security_policy|items -%}
   {{        directive }}{% if urls is not none %} {{ urls|join(' ') }}{% endif %};
   {%-   endfor -%}
   {%- else -%}
   {{    none }}
   {%- endif -%}
</code>
</pre>
<b>nginx_envs</b>: This is a <b>key</b> (also called a mapping key or dictionary key)
  The indented content under it is the <b>value associated</b> with that <b>key</b>.

<b>APACHE2_ADMIN_CSP</b>: This is a nested key

<b>|-</b>: This is a block scalar indicator (specifically a "literal block scalar, strip" indicator)
  - <b>|</b> means "literal block scalar" (preserves newlines)
  - <b>-</b> means "strip final newlines"

<h3>Jinja2 Elements within the value</h3>

- <b>{%- ... -%}</b> - Statement blocks or control structures (the - strips whitespace)
- <b>{{ ... }}</b> - Variable expressions or expression blocks
- <b>if, else, endif</b> - Control flow statements
- <b>for, endfor</b> - Loop statements
- <b>admin_content_security_policy</b> - Variables
|- <b>length, |items, |join(' ')</b> - Filters (transform values)
- <b>is not none</b> - Test (checks a condition)

<h2 class="highlighterred2">Encountered Error</h2>
When trying to make the Prefix of <b>APACHE2_ADMIN_CSP</b> ( so the "APACHE2") dynamical
and therefore replace it with a variable like:<pre><code class="lang-yaml">{webserver_prefix}_ADMIN_CSP:</code></pre>
We get an error saying: <b>line 735, column 3 did not find <i>expected key</i> in "/home/dave/src/ansible/tocco/global.yml"</b>

This is because, in our <b>Tocco-Setup</b> we use a python script (inventory.py) and this takes the
config-file as it is in for ex. <i>global.yml</i> makes a yaml file out if and then the Jinja2 replacement takes place.
<b class="highlighterorange">PEGE</b>: <span class="highlighterorange">"Yeah, that's because in Yaml a value starting with a { is the start of a dictionary. It'll see a dictionary with one
item {webserver_prefix} and tread ADMIN_CSP as some invalid value after it. You also can't use some other characters
like [ / - (start of a list, or * (a reference) but { is particularly annoying because it's used by Jinja2. "</span>


</pre></div>
</div>
</div>
</body></html></div>
</div>
</div>
</body></html><!--## yaml-with-jinja2-elements #################################################################################################################-->