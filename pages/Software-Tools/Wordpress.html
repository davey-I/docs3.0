<!DOCTYPE html>
<html><head>
<title data-folder-path="/Software-Tools">Wordpress</title>
<link href=" ../../static/style.css" rel="stylesheet"/>
<link href="../../prism/prism.css" rel="stylesheet"/>
</head>
<body class="body">
<div class="page-folder-header-div">
<h1 class="pagetitle" data-folder-path="Software-Tools">Wordpress</h1>
<a href="./../..">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M3 11L12 4L21 11"></path>
<path d="M5 10V20H19V10"></path>
<path d="M10 20V14H14V20"></path>
</svg>
</a>
</div>
<!-- Sidebar -->
<div class="sidbear-enclosure-open" id="sidbear-enclosure-open-Wordpress">
<button class="sidbear-enclosure-button-open" id="sidbear-enclosure-button-Wordpress" onclick="toggle_sidebar()" type="button">
<svg fill="white" height="30" viewBox="0 0 100 80" width="30" xmlns="http://www.w3.org/2000/svg">
<rect height="10" width="100"></rect>
<rect height="10" width="100" y="30"></rect>
<rect height="10" width="100" y="60"></rect>
</svg>
</button>
<div class="sidebar-mainbox-open" id="sidebar-mainbox-Wordpress">
<div class="sidebar-subbox-open" id="sidebar-subbox-1" onclick=" append_foldable_content()">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" x2="12" y1="8" y2="16"></line>
<line x1="8" x2="16" y1="12" y2="12"></line>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-2">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
<div class="sidebar-subbox-open" id="sidebar-subbox-3">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10"></circle>
<path d="M9.09 9C9.32591 8.33109 9.78918 7.76807 10.4 7.41421C11.0108 7.06036 11.7266 6.93913 12.4152 7.07107C13.1038 7.20302 13.7206 7.57857 14.162 8.12132C14.6034 8.66407 14.8397 9.33984 14.83 10.03C14.83 12 12.5 12.5 12.5 14"></path>
<circle cx="12" cy="17" r="1"></circle>
</svg>
</div>
</div>
</div>
<script src="../../prism/prism.js"></script>
<script src="../../static/script.js"></script>
<!--## To-Delete-On-IWay-After-Releasewechsel #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-To-Delete-On-IWay-After-Releasewechsel">
<h2 class="foldable-title" id="foldable-title-To-Delete-On-IWay-After-Releasewechsel">To-Delete-On-IWay-After-Releasewechsel</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('To-Delete-On-IWay-After-Releasewechsel')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-To-Delete-On-IWay-After-Releasewechsel', 'foldable-content-penButton-To-Delete-On-IWay-After-Releasewechsel')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-To-Delete-On-IWay-After-Releasewechsel" onclick="add_subdiv('editable-paragraph-To-Delete-On-IWay-After-Releasewechsel')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-To-Delete-On-IWay-After-Releasewechsel">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-To-Delete-On-IWay-After-Releasewechsel" onclick="save_editable_content('Wordpress','editable-paragraph-To-Delete-On-IWay-After-Releasewechsel', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-To-Delete-On-IWay-After-Releasewechsel"><h3> Example CWB Releasewechsel</h3>
<li>wenn configs entfernt, angepasst werden sollten diese grundsätzlich <b>immer</b><br/>
       <b>gleich auch angewendet</b> werden um zu prüfen, ob sie noch funktionieren
</li><br/>
<li>Da dies bei der <b>php-config</b> für cwb z.b. nicht gemacht wurde, führte es dazu,<br/>
       dass der Server nicht neustarten konnte da noch eine Link aus einem anderen<br/>
       PHP-Folder auf diese zeigte...
</li><br/>
<li> Ticket Example with what to delete : <b>OPS-1174</b> </li><br/>
<!--## Zu-entfernen #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Zu-entfernen">
<h2 class="foldable-title" id="foldable-title-Zu-entfernen">Zu-entfernen</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Zu-entfernen')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Zu-entfernen', 'foldable-content-penButton-Zu-entfernen')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Zu-entfernen">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Zu-entfernen" onclick="save_editable_content('Wordpress','editable-paragraph-Zu-entfernen', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Zu-entfernen"><pre>folgende Einträge wurden entfernt


    # vhost


link @ /var/www/vhosts/tocco.ch/web.cwbtesttemp  entfernen


ordner @ /var/www/vhosts/  entfernen


config in /etc/apache2/sites-available/web.cwbtesttemp.tocco.ch.conf 


/etc/apache2/sites-available auch noch eine "....tocco.ch.conf" entfernen


link in /etc/apache2/sites-enabled : web.cwbtesttemp.tocco.ch.conf -&gt; ../sites-available/web.cwbtesttemp.tocco.ch.conf


 


   # SSL links in ./etc/apache2/ssl/tocco.ch


link in ./etc/apache2/ssl/tocco.ch: web.cwbtesttemp.key -&gt; /etc/letsencrypt/live/web.cwbtesttemp.tocco.ch/privkey.pem


link in ./etc/apache2/ssl/tocco.ch: web.cwbtesttemp.pem -&gt; /etc/letsencrypt/live/web.cwbtesttemp.tocco.ch/fullchain.pem


#DB-Stuff


DROP DATABASE wp_NAME;

  # Zertifikate


Certificates removed, via certbot            


certbot delete --cert-name web.cwbtesttemp.tocco.ch


(evtl nur wegen temp. missconfig nach ansible-autosetup aber in
/etc/letsencrypt.bck/renewal war auch noch ein eintrag)
 

  # DNS Einträge (Nine)


CNAME         tocco.web.cwbtesttemp.tocco.ch                 cwbtestnew.tocco.ch 


CNAME         web.cwbtesttemp.tocco.ch                            wp2.stage.tocco.ch 



  # PHP config files in 


/etc/php/fpm-pools.d/



  # Apparmor config files in 


/etc/apparmor.d/php-fpm.d


/etc/apparmor.d/apache2.d


<h3> auf den entfernten Eintrag in etc/php/fpm-pools.d , zeigte noch ein Symlink in:</h3>


/etc/php/8.2/fpm/pool.d/

# version testen, einfach mal systemctl restart php-TABTAB... um die verion finden
<b>systemctl restart php-fpm.service # typical</b>

Welcher Probleme beim neustart des Servers verursachte, dieser muss also unbedingt auch entfernt werden.


#Users


Since manged by ansible we also have to delete the created user
wp-CUSTOMERNAME


sudo deluser wp-CUSTOMERNAME


<h4>At the end do a apache2ctl configtest and expect syntax OK </h4>
dont forget if not already done - <b>systemctl restart php-fpm.service    # typical</b>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<!--## Software-Tools-Wordpress-Setup-Wordpress-Stuff #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Software-Tools-Wordpress-Setup-Wordpress-Stuff">
<h2 class="foldable-title" id="foldable-title-Software-Tools-Wordpress-Setup-Wordpress-Stuff">Software-Tools-Wordpress-Setup-Wordpress-Stuff</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Software-Tools-Wordpress-Setup-Wordpress-Stuff')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Software-Tools-Wordpress-Setup-Wordpress-Stuff', 'foldable-content-penButton-Software-Tools-Wordpress-Setup-Wordpress-Stuff')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Software-Tools-Wordpress-Setup-Wordpress-Stuff" onclick="add_subdiv('editable-paragraph-Software-Tools-Wordpress-Setup-Wordpress-Stuff')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Software-Tools-Wordpress-Setup-Wordpress-Stuff">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Software-Tools-Wordpress-Setup-Wordpress-Stuff" onclick="save_editable_content('Wordpress','editable-paragraph-Software-Tools-Wordpress-Setup-Wordpress-Stuff', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Software-Tools-Wordpress-Setup-Wordpress-Stuff"><p>Atuell, (da noch nicht in Ansible eingepflegt) und Webkinder nicht ganz alles<br/>
auf dem IWay Server machen können, müssen wir bei neuen Setups voraus noch <br/>
<b>VHost, SSL-Cert und Maria-DB</b>. Dies wird durch maba kommuniziert und ist auch <br/>
auf dem Asana Board "Tocco - Plugin + Tocco-Template" unter "Todo" zu sehen.<br/><br/>
Da noch nicht 'Ansiblisier', muss dies alles mit den von IWay beim Einrichten des Servers <br/>
 in <b>/opt/script/</b> hinterlegten scripts  selber gemacht werden.
</p>  
<ul>
    <li>Login to Asana</li><br/>
    <li>Search Ticket from Rasti in Board "Tocco - Plugin + Tocco-Template"</li><br/>
    <li>Search subdomainname (probably smth. with 'temp'in it) in Ticket and create a CNAME:<br/>
<br/><ul>
<li>from this Subdomain to wp2.stage.tocco.ch directly <br/><b>CNAME</b>  web.$KUNDEtemp.tocco.ch  wp2.stage.tocco.ch <b>(bad practice)<b></b></b></li><br/>
<li>or via the  'zwischendomain' construct over which we have control all the time:<br/>
<b>CNAME</b> web.$KUNDEtemp.tocco.ch $KUNDEtest.wp.tocco.ch<br/>
which should already have a entrance :<br/><b>CNAME</b> web.$KUNDEtemp.tocco.ch $KUNDEtest.wp.tocco.ch
</li>
</ul>
    </li><br/>
    <li>Login to IWay ssh wp2.iway.tocco.ch</li><br/>
    <li>Now we need to:<br/>
      <ul>
<li>Execute 3 scripts in /opt/script: <b>apache-createvhost.sh, letsencypt-createcert.sh, mysql-createdatabase.sh</b><br/>
these scripts mostly need the domain name as input, but it can be checked by just not preventing any input or <br/>
check the script with <b>vim</b> there you see what you need to give it 
</li>
<li> <b> When we provide the domainname to the first script, we need to do it like this:<br/>
        if the domain is <b>bla.abcteest.tocco.ch</b> dann müssen wir diese dem Vhost script<br/>
        so übergeben, dass zwischen der domain <b>tocco.ch</b> und der subdomain ( egal wie lang)
        einfach der ganze kasumpel von sub-domain abstand Domain und dies übergeben.
</b></li>
 <li>Create DB credentials: pwgen -20, database, username <br/>
its basically just the customer name dbname for ex. "wp_ihkschwabentesttemp" <br/>
we can display with "mysql" then "show databases;" to see the already existing.<br/>
and connect to one "use wp_puschtesttemp;" ( not necessary but good to know for maria db)<br/><br/>


And then create a new .txt file in create a new filr in <b>cd /home/webkinder/db-credentials/</b> for Kiddies
</li>
</ul>
    </li><br/>
  </ul></div>
</div>
</div>
<!--## Restic-Backups #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Restic-Backups">
<h2 class="foldable-title" id="foldable-title-Restic-Backups">Restic-Backups</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Restic-Backups')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Restic-Backups', 'foldable-content-penButton-Restic-Backups')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Restic-Backups" onclick="add_subdiv('editable-paragraph-Restic-Backups')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Restic-Backups">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Restic-Backups" onclick="save_editable_content('Wordpress','editable-paragraph-Restic-Backups', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Restic-Backups"><pre><h3>Prerequisites for Login</h3>

Go to Infomaniak, choose <i>Web &amp; Domains</i> / <i>Cloud Server</i> and there the searched Installation.


On the L side of the page we choose <i>FTP / SSH</i>
there we can find the user-name for the corresponding Installation.
<ul>
<li>If Login does not work, click SSH button for web-console go to .ssh/authorized_keys and add</li>
<li>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICEUJzZ8JF57iRaCgqKOWXGjIAnPzuYrFWyHImfrmxhS dain@tocco</li>
</ul>
SSH into server for ex: ssh zt2e8m_system@wp1.stage.tocco.ch

<h3>At this Point we follow the setup-guide:</h3>

- Download Binary: <i>wget -O restic.bz2 https://github.com/restic/restic/releases/download/v0.15.2/restic_0.15.2_linux_amd64.bz2</i>

- Unzip Make executable move and open in vim in a command:
<li>bunzip2 restic.bz2 &amp;&amp; chmod +x restic &amp;&amp; mv restic bin/ &amp;&amp; vim ~/resticconf

Insert following content ...:
.....
<pre><code class="lang-bash">
export OS_AUTH_URL=https://swiss-backup03.infomaniak.com/identity/v3
export OS_AUTH_VERSION=3
export OS_IDENTITY_API_VERSION=3
export OS_REGION_NAME=RegionOne
export OS_PROJECT_NAME=sb_project_SBI-MB294341
export OS_USERNAME=SBI-MB294341
export OS_PASSWORD='lq79gDZmC!C0'
export OS_USER_DOMAIN_NAME=default
export OS_PROJECT_DOMAIN_NAME=default
export RESTIC_REPOSITORY=swift:sb_project_SBI-MB294341:/svf
export RESTIC_PASSWORD_FILE=restickey
</code>
</pre>
.....
... into the config and adjust : “export RESTIC_REPOSITORY=swift:sb_project_SBI-MB294341:/svf
to the corresponding project...

<b>How to name that thing after the / ?</b>

- SVF = /svf
- SVF Test = /svftest
- LBBZ Test = /lbbztest

Create &amp; print the key (encryption key for backups)
this must of course also be stored in the secret / BW

<i>openssl rand -base64 16 &gt; restickey</i>
<i>cat restickey</i>

Create variable: </li><li>source resticconf

Init backup: </li><li>restic -r $RESTIC_REPOSITORY init

create mysql folder: </li><li>mkdir mysql-backups

Adapt to project before executing the cd command
<b> Tip: cd sites/ and TABTAB ..installation is already set up </b>
</li><li>cd sites/web.ihkschwaben.tocco.ch/

- Open config: </li><li>cat wp-config.php</li>

Dont worry if the <b>DB_USER &amp; DB_NAME</b> does not
Relate to the Installation-Name like for ex:

  - zt2e8m_svftest

These Names are just created based on the
Name that is set for the DB-User. This name
can be looked up after we click the button
Datenbank on Infomaniaks Web-UI view,
on the corresponding Customers Installation.

- Copy the following into a note:
<pre><code class="lang-bash">
// The name of the database for WordPress
define('DB_NAME', 'zt2e8m_svftest');

// MySQL database username
define('DB_USER', 'zt2e8m_svftest');

// MySQL database password
define('DB_PASSWORD', 'FM4_PzkFfT4');

// MySQL hostname
define('DB_HOST', 'zt2e8m.myd.infomaniak.com');
</code>
</pre>

Start to edit the cronjob with <i>crontab -e:</i>
und folgendes einfügen ( 1 oberhalb des bereits bestehenden )

- replace the following:
<pre><code class="lang-bash">
mysqlhost = 'DB_HOST', 'zt2e8m.myd.infomaniak.com'
dbuser = 'DB_USER', 'zt2e8m_svftest'
password = 'DB_PASSWORD', 'FM4_PzkFfT4'
dbname = 'DB_NAME', 'zt2e8m_svftest'
dbname (in mysql-backups/dbname) = 'DB_NAME', 'zt2e8m_svftest'

+ Zeit --keep-daily .. --keep-weekly .. anpassen auf wahrsch 45 / 12

Example When replaced: 0 23 * * * mysqldump -h zt2e8m.myd.infomaniak.com -u zt2e8m_svftest -p 'dneb/2jdn' zt2e8m_svftest &gt; mysql-backups/zt2e8m_svftest.sql

# MySQL Dumps
0 23 * * * mysqldump -h mysqlhost -u dbuser -p 'password' dbname &gt; mysql-backups/dbname.sql

# Restic Backup
15 23 * * * . ~/resticconf; ~/bin/restic backup sites/ mysql-backups

# Restic Cleanup
30 23 * * * . ~/resticconf; ~/bin/restic forget --keep-daily 45 --keep-weekly 12 --prune
</code>
</pre>
</pre></div>
</div>
</div>
<!--## Einleitung-Maba #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Einleitung-Maba">
<h2 class="foldable-title" id="foldable-title-Einleitung-Maba">Einleitung-Maba</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Einleitung-Maba')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Einleitung-Maba', 'foldable-content-penButton-Einleitung-Maba')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Einleitung-Maba" onclick="add_subdiv('editable-paragraph-Einleitung-Maba')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Einleitung-Maba">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Einleitung-Maba" onclick="save_editable_content('Wordpress','editable-paragraph-Einleitung-Maba', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Einleitung-Maba"><pre><div style="border-style:solid; border-color:yellow;">
   At the beginning, new Tocco-customers only have
   a <b>Pilot-Installation</b>. Therefore there is also only
   one Wordpress instance available.

   Dafür wird die Domain web.kundenname.tocco.ch
   verwendet.

   Wenn Kunden noch im <b>Pilot-Installation</b> sind, dann haben sie wie gesagt
   nur ein Prod-System (Tocco) + irgendwann kommt dann auch
   nur ein WP-System (WP-Pilot) hinzu, dies können wird
   dann so 1:1 wie im Domain add guide anwenden,
   ins Ansible eintragen und diese laufen lassen.

   Übersicht-Lösungen -&gt; OPS-726

   Bei Release Wechsel und dem erstellen von testnew/old solltesn eich
   die vom BS die DOmains selber unterhalb von wordpress:
   in Ansible einfügen. Dort muss man auch etwas schauenn wie, sieh Erklärung fasc

</div>

Sharepoint: tocco/installation/list
<b>Jira</b>: Weitere Übersicht OPS-726


<b>WP-Admins</b>: Marcel hat selber eine Excel liste wo manuell eingetragen (momentan)
Soll in Zukunft via Ansible gemacht werden.


<b>Neukunde</b>: Projektleiter schickt uns Jiraticket mit Wordpress-Checkliste, was
alles verwendet wird.Dann ... Wir erstellen Eintrag ins assana im
backlog, Webkinder machen alles ausser Backup restic, der rest sollte
dann auf dem Infomaniakk server bereit sein.




<b>Infomaniak</b>
Für Wordpress haben wir bei Infomaniak zwei server
Prod und Stage. Pilotinstallationen sind erst immer auf
Stage aufgebaut. Danach aufgeteilt.


Webkinder haben auch zugriff auf die Infomaniak Server.


Bei infomaniak für on_call → haben wir einen SLA(support
premium) ,bezüglich On_call supportnummer mit 24/7 notruf
oder mail.(muss kritisch sein)


Support infos auf der L seite “Support” ,aktuelles Problem Wenn user
A beim support ein ticket erstellt, sieht nur diese person das und
auch responses kommen nur da hin, wenn z.b. am MO dieser nicht da ist blööd


Wartungsfenster ist so gemacht, dass es gleich liegt wie bei VSHN, MI
morgen. Ebenfalls werden proinstallation ein User auf dem server
erstellt, jeder ein eigenes HOME


<b>Webkinder</b>
Webkinder machen alles Wordpress relatete
Plugins, Security Patches updates etc.


Pro Jahr führen Webkinder ein Upgrade durch
sodass die Woerdpress Installation danach
wieder auf dem aktuellst-möglichsten Stand ist.


Webkinder überwachen eigenltich alles via
Monitoring, klappt aber nicht immer so gut.
Darum sind auch alles Lösungen noch auf dem
Statuscake hinterlegt.


Wenn wordpress nicht geht dann kontakt aufnehmen
mit corina.Manchmal machen Kidies evtl. Updates
oder sonst was, das sollten wir wissen, manchmal
aber eben nicht.


Wenn ungeplant → herausfinden infomaniak schuld oder
kiddies(woerdpress) corina einfach an→ support@webkinder.ch


wenn nachts was wäre, pech kein SLA für nacht etc.
momentan für on_call keine möglichkeit


<b>Wordpress-Adminlogin</b>


Login immer via: web-singletemplate.tocco.ch/wp-admin
danach befindet man sich auf dem WP adming tool.


Grundsätzlich gibt es einfach ein default template welches dann von
Webkindern genommen wird und gemäss Kundenwünschen angepasst wird.
Seite sieht Grundsätzlich immer gleich aus bischen kleine spez. Änderungen, wie von Kiddies von unserer Vorlage gemacht
<div style="border-style: solid;">


   Singlesite-Template -&gt; web-singletemplate.tocco.ch


   Multisite-Templates -&gt; web-multitemplate1.tocco.ch &amp; web-multitemplate2.tocco.ch
   (diese Könnten z.b. zwei komplet unterschiedliche "Auftritte" ermöglich)


   In diesen sollte nie etwas geändert werden !
</div>


<b> Wer hat nun dort admin-rechte, kann sich also in diese Wordpress ansicht einloggen ?</b>
<ul>
- maba gewährt admin logins an dain und BS-Supporters mar25

- Momentan führt maba manuell eine Liste, dort steht zu jeder Inst.
  Wer wo welchen Zugriff hat.


- Auf der Testinstallation haben meist mehr User Adminrechte als auf Prod.


- In Zukunft soll dies evtl. über Ansible geregelt werden.


- Kunden sollten eigentlich nie Adminrechte haben, da sie sonst selber
neue User adden und diesen Adminrechte geben können.


- Kunden/Agenturen sollten nur Redakteurrechte haben.


- Es sollte auch vermieden werden, dass Kunden in Zukunft
  einfach beim Support einen Auftrag für ein neues Login
  geben und ihnen dieses dann einfach erstellt wird.


- Ebenfalls könnten Kunden mit Adminrechten selber Plugins
  etc. erstellen / hinzufügen.
</ul>


Wesentliche Einstellungsoptionen auf der WP-Adminseite ?
auf L seite Einstellungen/Tocco Plugin, z.b. wer wieviel sieht auf
dem Tocco Extranet, ( z.b. Inhalte nur sehen, wenn Extranet-User)
</pre></div>
</div>
</div>
<!--## Domain-Erklärung-fasc #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Domain-Erklärung-fasc">
<h2 class="foldable-title" id="foldable-title-Domain-Erklärung-fasc">Domain-Erklärung-fasc</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Domain-Erklärung-fasc')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Domain-Erklärung-fasc', 'foldable-content-penButton-Domain-Erklärung-fasc')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Domain-Erklärung-fasc" onclick="add_subdiv('editable-paragraph-Domain-Erklärung-fasc')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Domain-Erklärung-fasc">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Domain-Erklärung-fasc" onclick="save_editable_content('Wordpress','editable-paragraph-Domain-Erklärung-fasc', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Domain-Erklärung-fasc"><pre>            ihkschwaben:
            installations:
              ihkschwaben:                        # produktiv Tocco / ihk.tocco.ch
                branch: releases/3.9              # Tocco Version wo de Chund druf lauft
                wordpress:
                  portal.schwaben.ihk.de:         # produktiv WP / Domäne vom Chund vorgäh, mir hend kei Zuegriff uf de DNS
              ihkschwabentest:                    # testing Tocco / ihktest.tocco.ch
                branch: releases/3.9              # Glichi Tocco Version wie prod
                wordpress:
                  test-portal.schwaben.ihk.de:    # testing WP / Domäne heisst glich wie bi prod, nur mit "test-"


          Dä chund gaht jetzt in Release Wechsel vo de Version 3.9 uf 3.12, denn chunnt es neus
          Testsystem mit em Name testnew dezue:


          ihkschwaben:
            installations:
              ihkschwaben:                              
                branch: releases/3.9                    
                wordpress:
                  portal.schwaben.ihk.de:               
              ihkschwabentest:                          
                branch: releases/3.9                    
                wordpress:
                  test-portal.schwaben.ihk.de:          
              ihkschwabentestnew:                  # neui Tocco Installation, wo s ganze Release upgrade druf gmacht wird
                branch: releases/3.12              # Tocco Version wird ahpasst
                wordpress:
                  web.ihkschwabentesttemp.tocco.ch:        # Die Temp Wordpress Domäne wird verwendet /mir hend d
                                                                                       kontrolle über de DNS und müend nöd uf de Chund warte         




          Nachdem s Release Upgrade irgendwenn fertig / tested und vom Chund abgno isch, denn wirds
          uf prod gmacht:


          ihkschwaben:
            installations:
              ihkschwaben:                              
                branch: releases/3.12             # Tocco Version wird ahpasst uf das vom testnew
                wordpress:
                  portal.schwaben.ihk.de:               
              ihkschwabentestold:                 # Die Installation wird umbenännt vo "test" uf "testold" / ihkschwabentestold.tocco.ch                          
                branch: releases/3.9              # Das bliebt d Tocco Version immer nah uf em alte vor em Release Upgrade
                wordpress:
                  web.ihkschwabentesttemp.tocco.ch# D Wordpress Domäne änderet sich ih dem schritt uf d "testtemp"
              ihkschwabentest:                    # Die Tocco Installation wird vo "testnew" uf "test" umbenennt, will deht s Release upgrade gmacht worde# 
               ihkschwaben.tocco.ch                        
                branch: releases/3.12                    
                wordpress:      
                  test-portal.schwaben.ihk.de:    # Die Installation bechunnt jetzt wieder die reguläri WP Domäne wo au mit de prod übereinstimmt


          De Name "testtemp" isch nur defür da, dass mer die ohni grossi verwirrig zwüsched dene "testnew"
          und "testold" Installatione chönnd umeschiebe und nöd jedesmal wieder en neue DNS Ihtrag müend
          erstelle, ahpasse und wieder ufrume. Nach ere gwüsse Zyt wird denn d "testold" Installation
          ufgrumt und denn gsehts nur nah so us:


          ihkschwaben:
            installations:
              ihkschwaben:                              
                branch: releases/3.12
                wordpress:
                  portal.schwaben.ihk.de:               
              ihkschwabentest:                        
                branch: releases/3.12                    
                wordpress:      
                  test-portal.schwaben.ihk.de:
        
</pre></div>
</div>
</div>
<!--## Domain-Add-Guide #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Domain-Add-Guide">
<h2 class="foldable-title" id="foldable-title-Domain-Add-Guide">Domain-Add-Guide</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Domain-Add-Guide')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Domain-Add-Guide', 'foldable-content-penButton-Domain-Add-Guide')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Domain-Add-Guide" onclick="add_subdiv('editable-paragraph-Domain-Add-Guide')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Domain-Add-Guide">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Domain-Add-Guide" onclick="save_editable_content('Wordpress','editable-paragraph-Domain-Add-Guide', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Domain-Add-Guide"><pre>Wenn pilot installation aufgesetzt wurde bsp: pusch:


Pusch kann als Bsp. genommen werden, ist evtl.
etwas verwirrend, da die nich mehr im Pilot sind und die Angaben z.b. im Tocco-Wordpress
nicht mehr mit dem Übereinstimmen, was wir halt als Standard einstellen web.blabla...
in zwischenzeit sind dort neue wp.tocco domains hinzugekommen, die Kundenwünschen entsprechen.


Momentan 01.2025 ist suissetec ein einfacheres bsp..


<h3>Nine</h3>


push.tocco.ch -&gt; os4.tocco.ch
tocco.web.pusch.tocco.ch -&gt; pusch.tocco.ch
web.pusch.tocco.ch -&gt; wp1.prod.tocco.ch


<h3>Ansible</h3>


Unter wordpress: folgenden Eintrag adden...
web.pusch.tocco.ch:


<b>Irgendwann wird Pilot dann aufgeteilt und es kommen die folgenden Einträge neu dazu</b>


<h3>Nine</h3>


pushtest.tocco.ch -&gt; os4.tocco.ch
tocco.test-web.pusch.tocco.ch -&gt; puschtest.tocco.ch
test-web.pusch.tocco.ch -&gt; wp1.stage.tocco.ch


<h3>Ansible</h3>


Unter wordpress: folgenden Eintrag adden...
test-web.pusch.tocco.ch:


</pre></div>
</div>
</div>
<!--## Go-Live #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Go-Live">
<h2 class="foldable-title" id="foldable-title-Go-Live">Go-Live</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Go-Live')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Go-Live', 'foldable-content-penButton-Go-Live')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Go-Live" onclick="add_subdiv('editable-paragraph-Go-Live')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Go-Live">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Go-Live" onclick="save_editable_content('Wordpress','editable-paragraph-Go-Live', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Go-Live"><pre>- Findet immer Mi zwischen 12:00 und 13:00
statt und werden Kunden natürlich mitgeteilt.

- Test und kleine anpassungen werden
nicht den kunden mitgeteilt merkt man
meist nicht

- During the Go-Live, the Pilot-Installation gets changed to
Production &amp; Testsystem. Wordpress gets split into two instances too
Therefore customer also needs to adjust domain at its DNS-Hoster.

- We at tocco need to adjust:
<ul>
- The domains in ansible
- Delete Domains in Nine-Cockpit
</ul>
Small convention for domain naming only for test-system
<b>test-tocco</b>.<i>{kundenname}</i> immer diesen <b>präfix</b> verwenden.

After the Go_Live the swiss-backups need to be setup
therefore see Restic_Backups entrance at <a href="../Software-Tools/Wordpress.html">Restic-Backups</a>
</pre></div>
</div>
</div>
<!--## Add-Domains-To-CORS #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Add-Domains-To-CORS">
<h2 class="foldable-title" id="foldable-title-Add-Domains-To-CORS">Add-Domains-To-CORS</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Add-Domains-To-CORS')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Add-Domains-To-CORS', 'foldable-content-penButton-Add-Domains-To-CORS')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Add-Domains-To-CORS" onclick="add_subdiv('editable-paragraph-Add-Domains-To-CORS')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Add-Domains-To-CORS">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Add-Domains-To-CORS" onclick="save_editable_content('Wordpress','editable-paragraph-Add-Domains-To-CORS', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Add-Domains-To-CORS"><pre>Webkiddies asking for portal.physioswiss.webkinder.dev
beeing added to CORS...

To do
- portal.physioswiss.webkinder.dev für physioswiss.tocco.ch für CORS freischalten

<b>! Method 1 might also be affected
by pege's changes see Method 2... !</b>

Find installation in ansible config.yml

If they want to use our widgets/wordpress, they have to add a CNAME
tocco.portal.physioswiss.webkinder.dev IN CNAME physioswiss.tocco.ch

And we simply just add the domain portal.physioswiss.webkinder.dev underneath "Wordpress"
              wordpress:
                physioswiss.webkinder.dev:
                physioswiss-widgets.webkinder.dev:
                portal.physioswiss.webkinder.dev:
           
If they built everything by themself, without our widgets/wordpress ...

<i>"sie hend portal.physioswiss.webkinder.dev wo was komplett eiges isch
(kei wordpress vo üs) wo sie üsi REST API uf physioswiss.tocco.ch bruched"</i>

add like this https://gitlab.com/toccoag/ansible/-/commit/2114311e5f73be7b4c9f0223f506eb60f72f6631

  installations:
    maltech:
      additional_request_origins:
      - http://local.maltech.ch
      - https://local.maltech.ch
      - https://83.169.18.62
      - http://83.169.18.62
      branch: releases/3.8

<b>Not with env: ... anymore</b>
</pre></div>
</div>
</div>
<!--## Anpassung-Templates-On-Tocco-Version-Change #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-Anpassung-Templates-On-Tocco-Version-Change">
<h2 class="foldable-title" id="foldable-title-Anpassung-Templates-On-Tocco-Version-Change">Anpassung-Templates-On-Tocco-Version-Change</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('Anpassung-Templates-On-Tocco-Version-Change')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-Anpassung-Templates-On-Tocco-Version-Change', 'foldable-content-penButton-Anpassung-Templates-On-Tocco-Version-Change')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-Anpassung-Templates-On-Tocco-Version-Change" onclick="add_subdiv('editable-paragraph-Anpassung-Templates-On-Tocco-Version-Change')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-Anpassung-Templates-On-Tocco-Version-Change">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-Anpassung-Templates-On-Tocco-Version-Change" onclick="save_editable_content('Wordpress','editable-paragraph-Anpassung-Templates-On-Tocco-Version-Change', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-Anpassung-Templates-On-Tocco-Version-Change"><pre>Wenn eine neue Tocco version deployed wird,
müssen auch die Domains zu den WP-templates
angepasst werden:


<h3>web-multitemplate1.tocco.ch, web-multitemplate1.tocco.ch, web-singletemplate.tocco.ch:</h3>


Dies muss nur in ansible gemacht werden, und maba testet dies dann
in dem er in unserem Tocco irgend eine Rolle erstellt und diese löst
dan in WP-Admin auf den Template-Seiten etwas aus, sodass dort dann
die neue Installation angezeigt wird und nicht mehr die alte ..
</pre></div>
</div>
</div>
<!--## ansible-automatisierungs-changes #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-ansible-automatisierungs-changes">
<h2 class="foldable-title" id="foldable-title-ansible-automatisierungs-changes">ansible-automatisierungs-changes</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('ansible-automatisierungs-changes')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-ansible-automatisierungs-changes', 'foldable-content-penButton-ansible-automatisierungs-changes')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-ansible-automatisierungs-changes" onclick="add_subdiv('editable-paragraph-ansible-automatisierungs-changes')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-ansible-automatisierungs-changes">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-ansible-automatisierungs-changes" onclick="save_editable_content('Wordpress','editable-paragraph-ansible-automatisierungs-changes', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-ansible-automatisierungs-changes"><pre><h3>pege automated a lot of the setup steps, this comes with adjustments for
 the ansible-config entrances</h3>

<h4>wordpress_server:</h4>
- testinstallations that use wordpress should now all have a 
<b> wordpress_server: wp2.stage.tocco.ch</b> entrance, since
 we moved all of test to IWay-Server

- This entrance is kind of a default, that tells on which server
 the WordPress-Test instance is runnign

- If for some reason, the WordPress-Testinstance is not 
 running on the IWay server (Own hosting or whatever...) we need
 to go to the tests <b>wordpress:</b> entrance add the Domain
 and then underneath this domain add a <b>wordpress_server: null</b> entrance
 like in this example:

<pre><code class="lang-yaml">
       wordpress:
         web.fdp.tocco.ch:
           wordpress_server: null
</code>
</pre>

- also ( like in the example above ) such an entrance can be present
 if the Installation is still in Pilote and WordPress only consists of 
 one Installation, which resides at Infomaniak Server (At the time,
 this will probably change in future ).

- This entrance from above then needs to be removed after the Installation
 is not Pilote anymore and its Test got moved to IWay, so we remove

<pre><code class="lang-yaml">
       wordpress:
         web.fdp.tocco.ch:
           wordpress_server: null
</code>
</pre>
and then replace it with

<pre><code class="lang-yaml">
       wordpress:
         ${WHATEVERDOMAIN}.ch:
</code>
</pre>
 If no <i>wordpress_server:</i> is defined underneath <b>wordpress:</b>
 the outer definition <b>wordpress_server: wp2.stage.tocco.ch&lt;(b&gt; is active.

</b></pre></div>
</div>
</div>
<!--## setup-wp-bestandskunden #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-setup-wp-bestandskunden">
<h2 class="foldable-title" id="foldable-title-setup-wp-bestandskunden">setup-wp-bestandskunden</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('setup-wp-bestandskunden')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-setup-wp-bestandskunden', 'foldable-content-penButton-setup-wp-bestandskunden')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-setup-wp-bestandskunden" onclick="add_subdiv('editable-paragraph-setup-wp-bestandskunden')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-setup-wp-bestandskunden">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-setup-wp-bestandskunden" onclick="save_editable_content('Wordpress','editable-paragraph-setup-wp-bestandskunden', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-setup-wp-bestandskunden"><pre>For ex. Tickets like: <i>ODAGS25CR-2</i>

- This setup is for <i>Bestandskunden</i> so, customers that are already
  using Tocco but no WordPress until this poinnt. In a first Step, only one
  instance gets set up on the <b>wp2.prod.tocco.ch</b> ( yes <b>prod</b>)
  even thought the route will be called <i>web..test.</i>
  This is done, because its considered a Testinstance ( because its the first one)
  that after testing gets converted into the prod-instance.

  This is done before Webkinder have setup the page.

<h4>Create DNS records</h4>
- We have to create three CNAME records:
<pre><code class="lang-bash">
CNAME odagtest.wp.tocco.ch wp2.prod.tocco.ch

CNAME tocco.web.odagtest.tocco.ch odagtest.tocco.ch

CNAME web.odagtest.tocco.ch odagtest.wp.tocco.ch
</code>
</pre>

<h4>Add entrance to tocco-config.yml</h4>
- We add the following to the Customers config:
<pre><code class="lang-yaml">
wordpress:
        odags:
          routes:
            web.odagstest.tocco.ch:
        wordpress_server: wp2.prod.tocco.ch

# so, that in the end we get:
    odagstest:
      branch: releases/3.12
      db_server: db5.stage.tocco.cust.vshn.net
      wordpress:
        odags:
          routes:
            web.odagstest.tocco.ch:
      wordpress_server: wp2.prod.tocco.ch
</code>
</pre>
-  Next we need to run the Ansible-Playbook inside the <b>/wordpress</b> folder located at:
  <b>src/ansible/wordpress</b> like this:
<pre><code class="lang-bash">
# <instance_name> is the thing we 
ansible-playbook playbook.yml --limit wp_<instance_name>
</instance_name></instance_name></code>
</pre>
<pre><code class="lang-yaml">
# in this case <instance_name> = "odags"
wordpress:
        odags:
</instance_name></code>
</pre>

- Also run the Playbook in /tocco ?? probably ok

- Silence the Grafana-Alert until Webkinder have set the page up

After playbook is through also check
<pre><code class="lang-bash">
pgerber@tocco01:/var/www/vhosts/master$ sudo aa-status |grep test314

#If nothing gets prionted
pgerber@tocco01:/var/www/vhosts/master$ sudo systemctl reload apparmor

# Then we should see something...
pgerber@tocco01:/var/www/vhosts/master$ sudo aa-status |grep test314
   apache2//test314
   php-fpm//test314
</code>
</pre>
</pre></div>
</div>
</div>

<!--## ansible-WordPress-automatisierung #################################################################################################################-->
<div class="foldable-container" id="foldcontainer-ansible-WordPress-automatisierung">
<h2 class="foldable-title" id="foldable-title-ansible-WordPress-automatisierung">ansible-WordPress-automatisierung</h2>
<button class="foldable-content-unfoldbutton" id="foldable-content-unfoldbutton-newchapter" onclick="toggleFoldableContent('ansible-WordPress-automatisierung')" type="button">
<svg class="arrow-icon" fill="currentColor" height="16" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M7 10l5 5 5-5H7z"></path>
</svg>
</button>
<button class="foldable-content-edittoggle" onclick="fetchEditableContent('Wordpress','editable-paragraph-ansible-WordPress-automatisierung', 'foldable-content-penButton-ansible-WordPress-automatisierung')" type="button">
<svg class="wrench-icon" fill="currentColor" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M22.7 19.3l-4.1-4.1c.6-1.1.9-2.3.9-3.5 0-3.9-3.1-7-7-7-1.3 0-2.5.3-3.5.9l3.3 3.3-4 4-3.3-3.3C4.3 10.5 4 11.7 4 13c0 3.9 3.1 7 7 7 1.3 0 2.5-.3 3.5-.9l4.1 4.1c.4.4 1 .4 1.4 0l2.7-2.7c.4-.4.4-1 0-1.4z"></path>
</svg>
</button>
<button class="create-subdiv" id="create-subdiv-ansible-WordPress-automatisierung" onclick="add_subdiv('editable-paragraph-ansible-WordPress-automatisierung')" type='*button"'>
<svg class="add-tag-icon" fill="none" height="22" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
<!-- < and > symbols -->
<path d="M6 8l-4 4 4 4"></path> <!-- Left angle bracket -->
<path d="M18 8l4 4-4 4"></path> <!-- Right angle bracket -->
<!-- Plus sign in center -->
<path d="M12 10v4"></path>
<path d="M10 12h4"></path>
</svg>
</button>
<div class="foldable-content folded" id="foldable-content-ansible-WordPress-automatisierung">
<button class="foldable-content-penButton-hidden" id="foldable-content-penButton-ansible-WordPress-automatisierung" onclick="save_editable_content('Wordpress','editable-paragraph-ansible-WordPress-automatisierung', 'page-folder')" type="button">
<svg fill="none" height="30" stroke="white" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
<path d="M12 20h9"></path>
<path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
</svg>
</button>
<div class="editable-paragraph" contenteditable="false" id="editable-paragraph-ansible-WordPress-automatisierung"><html><head></head><body><pre><h2>Add Customer</h2>
--------------------------------------------------------------------------------------------------------------------------------------------------------------------


- There is an entrance on how to add somewhere further up in the document


--------------------------------------------------------------------------------------------------------------------------------------------------------------------
<h2>Remove Customer</h2>
Basically check <a href="https://docs.tocco.ch/devops/managing_tocco/remove_customer.html">Docs</a>


<h3>But be aware of these things</h3>

-  <b>BS</b> People will have removed the whole Ansible-Entrance before
    we <b>DevOps</b> get informed to remove WordPress. Therefore
    the entrance in <i>/src/ansible/tocco.config.yml</i> for that installation
    will already be gone and we need to do a <b>git revert ${commit-id}</b>
    on the commit, so we can add the <span class="highlighterorange">wordpress_state: absent</span>

- Be sure to run the ansible playbook in <i>src/ansible/wordpress</i> with -l <b>wp_${WP-SITE-NAME}</b>
  not <span class="highlighterred">-l ${NICE-INSTALLATION-NAME}</span> like used to from <i>/tocco</i> playbook.

- And <b>yes</b> in most cases it has to be done including the scary sounding <b>-t all,force-irrevocable-removal</b>
  since all installations have their own maria-db, even testtemp and so on.
</pre></body></html></div>
</div>
</div>
</body></html>